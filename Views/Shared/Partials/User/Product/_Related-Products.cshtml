@using BaiTap_03_23WebC_Nhom10.Service;
@using System.Globalization;
@using BaiTap_03_23WebC_Nhom10.Models;
@{

    var products = Context.Items["products"] as List<Product> ?? new List<Product>();
    var culture = new CultureInfo("vi-VN");
}

<div class="related-products-wrapper">
    <h2 class="related-products-title">Related Products</h2>
    <div class="related-products-carousel">
        @foreach (var p in products)
        {

            double discountedPrice = p.DonGia * (1 - p.DonGiaKhuyenMai);
            string formattedDiscountedPrice = discountedPrice.ToString("N0", culture);
            string formattedOriginalPrice = p.DonGia.ToString("N0", culture);

            <div class="single-product">
                <div class="product-f-image">
                    <img src="~/img/@p.HinhAnh" alt="">
                    <div class="product-hover">
                        <a href="" class="add-to-cart-link"><i class="fa fa-shopping-cart"></i> Add to cart</a>
                        <a asp-controller="product" asp-action="detail" asp-route-id="@p.MaSp" class="view-details-link"><i class="fa fa-link"></i> See details</a>
                    </div>
                </div>

                <h2><a asp-controller="product" asp-action="detail" asp-route-id="@p.MaSp">@p.TenSp</a></h2>

                <div class="product-carousel-price">

                    @if (p.DonGiaKhuyenMai > 0)
                    {
                        <ins>@formattedDiscountedPrice VNĐ</ins>

                        <del>@formattedOriginalPrice VNĐ</del>
                    }
                    else
                    {
                        <ins>@formattedOriginalPrice VNĐ</ins>
                    }
                </div>
            </div>
        }
    </div>
</div>